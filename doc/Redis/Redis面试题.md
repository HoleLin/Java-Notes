### Redis 面试题

#### Redis雪崩问题

* 描述

  >**现象**：大量key同一时间点失效，同时又有大量请求打进来，导致流量直接打在DB上，造成DB不可用。

* **解决方案**：

  - 设置key永不失效（热点数据）；
  - 设置key缓存失效时候尽可能错开(把每个 Key 的失效时间都加个随机值就好了，这样可以保证数据不会再同一时间大面积失效。)；
  - 使用多级缓存机制，比如同时使用redsi和memcache缓存，请求->redis->memcache->db；
  - 购买第三方可靠性高的Redis云服务器；

#### 缓存穿透问题

* **描述**

  > **现象**：用户大量并发请求的数据(key)对应的数据在redis和数据库中都不存在，导致尽管数据不存在但还是每次都会进行查DB。
  >
  > 为什么key对应数据在缓存和db中不存在还会每次都进行DB查询呢？因为很多开发同学写的代码写的逻辑都是先从redis缓存中查一把，如果缓存中为空则从DB中查，如果DB中查到的数据不为空则设置到缓存并返回给接口。那么问题来了，如果从DB中查询的数据为空呢？？

* **解决方案**：

  - 从DB中查询出来数据为空，也进行空数据的缓存，避免DB数据为空也每次都进行数据库查询；

  - 使用布隆过滤器，但是会增加一定的复杂度及存在一定的误判率；

    ```xml
    <dependencies>  
         <dependency>  
             <groupId>com.google.guava</groupId>  
             <artifactId>guava</artifactId>  
             <version>23.0</version>  
         </dependency>  
    </dependencies>  
    ```

    

  